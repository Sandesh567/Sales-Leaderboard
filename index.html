<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sales Leaderboard</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body { background-color: #f8f9fa; padding: 50px; }
        .leaderboard-card { background: white; border-radius: 15px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); padding: 30px; }
        .rank-1 { background-color: #ffd700; font-weight: bold; } /* Gold for 1st */
    </style>
</head>
<body>

<div class="container">
    <div class="leaderboard-card">
        <h2 class="text-center mb-4">ðŸ“Š Sales Leaderboard</h2>
        
        <table class="table table-hover">
            <thead class="table-dark">
                <tr>
                    <th>Rank</th>
                    <th>Agent Name</th>
                    <th>Total Sales ($)</th>
                    <th>Total Deals</th>
                </tr>
            </thead>
            <tbody id="leaderboard-data">
                <tr>
                    <td colspan="4" class="text-center">Loading leaderboard...</td>
                </tr>
            </tbody>
        </table>
    </div>
</div>

<script>
    // This function runs as soon as the page loads
    async function fetchLeaderboard() {
        try {
            // 1. Fetch data from your backend
            const response = await fetch('http://localhost:3000/api/leaderboard');
            const data = await response.json();

            // 2. Get the table body element
            const tableBody = document.getElementById('leaderboard-data');
            tableBody.innerHTML = ''; // Clear the "Loading..." text

            // 3. Loop through data and create rows
           data.forEach(agent => {
    // 1. Create a variable for the rank display
    // If rank is 1, add the medal emoji; otherwise, just show the number
            let rankDisplay = agent.rank;
            if (agent.rank === 1) {
                rankDisplay = `ðŸ¥‡ ${agent.rank}`;
            } else if (agent.rank === 2) {
                rankDisplay = `ðŸ¥ˆ ${agent.rank}`;
            } else if (agent.rank === 3) {
                rankDisplay = `ðŸ¥‰ ${agent.rank}`;
            }

            const row = `
                <tr class="${agent.rank === 1 ? 'rank-1' : ''}">
                    <td>${rankDisplay}</td> <td>${agent.name}</td>
                    <td>${agent.totalSales.toLocaleString()}</td>
                    <td>${agent.totalDeals}</td>
                </tr>
            `;
            tableBody.innerHTML += row;
        });
        } catch (error) {
            console.error('Error fetching data:', error);
            document.getElementById('leaderboard-data').innerHTML = 
                '<tr><td colspan="4" class="text-danger text-center">Failed to load data. Is the server running?</td></tr>';
        }
    }

    // Call the function
    fetchLeaderboard();
</script>

</body>
</html>